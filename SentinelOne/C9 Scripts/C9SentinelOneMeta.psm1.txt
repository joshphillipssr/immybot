function Get-C9S1ServiceState {
    # .SYNOPSIS (Specialist) Gets the existence and running state of the four core S1 services.
    # (Function remains unchanged, it's already a good specialist)
    [CmdletBinding()]
    param()
    $serviceReportList = Invoke-ImmyCommand -ScriptBlock {
        $serviceNames = @("SentinelAgent", "SentinelHelperService", "SentinelStaticEngine", "LogProcessorService")
        $reportArray = @()
        foreach ($name in $serviceNames) {
            $service = Get-Service -Name $name -ErrorAction SilentlyContinue
            $existence = if ($null -ne $service) { "Exists" } else { "Not Found" }
            $runningState = if ($null -ne $service) { $service.Status.ToString() } else { "N/A" }
            $serviceObject = New-Object -TypeName PSObject
            Add-Member -InputObject $serviceObject -MemberType NoteProperty -Name 'Service' -Value $name
            Add-Member -InputObject $serviceObject -MemberType NoteProperty -Name 'Existence' -Value $existence
            Add-Member -InputObject $serviceObject -MemberType NoteProperty -Name 'RunningState' -Value $runningState
            $reportArray += $serviceObject
        }
        return $reportArray
    }
    return $serviceReportList
}